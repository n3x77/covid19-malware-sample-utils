package main

import (
	"flag"
	"os"

	log "github.com/sirupsen/logrus"
)

type MalwareBazaarCollector struct {
	URL   string
	Token string
}

func Init() {
	noMalwareBazaar := flag.Bool("no-mwb", false, "Do not use Malware Bazaar")
	mwbC := MalwareBazaarCollector{
		URL:   "https://mb-api.abuse.ch/api/v1/",
		Token: os.Getenv("MWB_TOKEN"),
	}
	if *noMalwareBazaar {
		log.Info("MalwareBazaar collector disabled.")
	}
	log.Debug("Using MalwareBazaar Collector with token: ", mwbC.URL, mwbC.Token)
}

func QueryMalwareBazaar() {
	log.Debug("Querying Malware Bazaar...")
	Init()
}
